<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSVP | Marilyn & Ian Wedding 2027</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ’’</text></svg>">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined&icon_names=calendar_add_on,map_pin_heart" />
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <!-- Navigation -->
    <nav>
        <ul>
            <li><a href="/#home">Home</a></li>
        </ul>
    </nav>

    <!-- RSVP -->
    <section id="rsvp" style="margin-top: 80px;">
        <h2>RSVP</h2>
        <div class="divider"></div>

        <!-- Placeholder messages when form is not available -->
        <div id="rsvpNotOpen" class="rsvp-placeholder hidden">
            <h3>Hey there early bird!</h3>
            <p>How did you find us? The RSVP form isn't open just yet, but you won't have to wait long!</p>
            <p>Check back soon for updates.</p>
        </div>

        <div id="rsvpClosed" class="rsvp-placeholder hidden">
            <h3>RSVPs are now closed</h3>
            <p>If you still need to let us know about your attendance, or need to change or confirm any details of your RSVP, please contact us directly.</p>
            <p>We can't wait to see you!</p>
        </div>

        <div id="rsvpAfterWedding" class="rsvp-placeholder hidden">
            <img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExbXdhdng2c3NpdDl0dzF3YmhuMzBuM3VsODkxdTVhazdhMDRoZGgyNyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/26grASJLVQG7tg8wM/giphy.gif" alt="Ferris Bueller - Go Home" style="max-width: 100%; border-radius: 10px;">
            <p style="margin-top: 1rem; font-style: italic;">"You're still here? It's over. Go home. Go."</p>
        </div>

        <div class="rsvp-form" id="rsvpForm-container">
            <form id="rsvpForm">
                <div class="form-group">
                    <label for="name">Full Name</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="attendance">Will you be attending?</label>
                    <select id="attendance" name="attendance" required>
                        <option value="">Select...</option>
                        <option value="yes">Joyfully Accept</option>
                        <option value="no">Regretfully Decline</option>
                    </select>
                </div>
                <div class="form-group" id="guestsGroup" style="display: none;">
                    <label for="guests">Number of Attendees (including you)</label>
                    <select id="guests" name="guests">
                        <option value="">Select...</option>
                        <option value="1">1 (just you)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                    </select>
                </div>
                <div class="form-group" id="guestNamesGroup" style="display: none;">
                    <label>Names of additional guests in your party (please include surname):</label>
                    <div id="guestNamesContainer" style="margin-top: 0.5rem;">
                        <!-- Text boxes will be dynamically generated here -->
                    </div>
                </div>
                <div class="form-group" id="dietaryRestrictionsGroup" style="display: none;">
                    <label style="margin-bottom: 1rem; display: block;">
                        Do you have any dietary choices/restrictions or allergies we should be aware of?
                    </label>
                    <div style="overflow-x: auto;">
                        <table class="meal-grid" id="dietaryRestrictionsTable">
                            <!-- Table will be dynamically generated -->
                        </table>
                    </div>
                </div>
                <div class="form-group" id="dietaryDetailsGroup" style="display: none;">
                    <label for="dietaryDetails">Please specify the 'Other' dietary restrictions/allergies:</label>
                    <textarea id="dietaryDetails" name="dietaryDetails" placeholder="e.g., John Smith - egg allergy, Jane Smith - lactose intolerant"></textarea>
                </div>
                <div class="form-group" id="mealSelectionGroup" style="display: none;">
                    <label style="margin-bottom: 1rem; display: block;">
                        <span style="color: #d9534f; font-weight: bold;">TBC:</span> Please select your main course preference:
                    </label>
                    <div style="overflow-x: auto;">
                        <table class="meal-grid" id="mealSelectionTable">
                            <!-- Table will be dynamically generated -->
                        </table>
                    </div>
                </div>
                <div class="form-group" id="stayingOvernightGroup" style="display: none;">
                    <label for="stayingOvernight">Are you thinking of staying overnight at Larmer Tree?</label>
                    <select id="stayingOvernight" name="stayingOvernight">
                        <option value="">Select...</option>
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                </div>
                <div class="form-group" id="accommodationGroup" style="display: none;">
                    <label for="accommodation">Where are you planning to sleep?</label>
                    <select id="accommodation" name="accommodation">
                        <option value="">Select...</option>
                        <option value="yurt">I would like information about hiring a glamping yurt</option>
                        <option value="tent">My own tent/caravan/campervan</option>
                    </select>
                </div>
                <div class="form-group" id="songRequestGroup" style="display: none;">
                    <label for="songRequest">Finally: What song is likely to get you on the dancefloor?</label>
                    <input type="text" id="songRequest" name="songRequest" placeholder="song name by artist">
                </div>
                <button type="submit" class="btn">Submit RSVP</button>
                <!-- investigate submitting to an online spreadsheet-->
            </form>
        </div>
    </section>

    <script>
    // Check RSVP availability and show appropriate content
    // This runs after script.js loads so rsvpOpen variable is available
    function checkRSVPAvailability() {
        const weddingDate = new Date('2027-06-19');
        // TEST: Simulate being after the wedding
        const currentDate = new Date('2027-07-01');
        const sixWeeksBeforeWedding = new Date(weddingDate);
        sixWeeksBeforeWedding.setDate(weddingDate.getDate() - 42);

        const formContainer = document.getElementById('rsvpForm-container');
        const notOpenMsg = document.getElementById('rsvpNotOpen');
        const closedMsg = document.getElementById('rsvpClosed');
        const afterWeddingMsg = document.getElementById('rsvpAfterWedding');

        // Hide all by default
        if (formContainer) formContainer.classList.add('hidden');
        if (notOpenMsg) notOpenMsg.classList.add('hidden');
        if (closedMsg) closedMsg.classList.add('hidden');
        if (afterWeddingMsg) afterWeddingMsg.classList.add('hidden');

        if (currentDate >= weddingDate) {
            // After wedding - show Ferris Bueller
            if (afterWeddingMsg) afterWeddingMsg.classList.remove('hidden');
        } else if (currentDate >= sixWeeksBeforeWedding) {
            // Within 6 weeks of wedding - RSVPs closed
            if (closedMsg) closedMsg.classList.remove('hidden');
        } else if (typeof rsvpOpen !== 'undefined' && rsvpOpen === true) {
            // RSVP is open - show form
            if (formContainer) formContainer.classList.remove('hidden');
        } else {
            // RSVP not open yet - show early bird message
            if (notOpenMsg) notOpenMsg.classList.remove('hidden');
        }
    }

    // Run after window fully loads (including script.js)
    window.addEventListener('load', checkRSVPAvailability);
    </script>

    <!-- Footer -->
    <footer>
        <p>We can't wait to celebrate with you!</p>
        <p style="margin-top: 0.5rem;">&hearts; Marilyn & Ian &hearts;</p>
    </footer>

    <script src="/script.js"></script>
</body>
</html>
