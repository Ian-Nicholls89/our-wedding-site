<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marilyn & Ian | Wedding 2027</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined&icon_names=calendar_add_on,map_pin_heart" />
    <script>
        const rsvpOpen = false;
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f0f8f8;
        }

        .material-symbols-outlined {
            font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24
        }

        .hidden {
            display: none !important;
        }

        /* Hero Section */
        .hero {
            height: 100vh;
            background: linear-gradient(135deg, rgba(64, 181, 173, 0.95), rgba(156, 207, 216, 0.95)),
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800"><rect fill="%239ccfd8" width="1200" height="800"/></svg>');
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            position: relative;
        }

        .hero-content {
            z-index: 2;
        }

        .hero h1 {
            font-size: 4.5rem;
            font-weight: 300;
            letter-spacing: 0.3rem;
            margin-bottom: 1rem;
            animation: fadeInUp 1s ease;
        }

        .hero .ampersand {
            font-size: 5rem;
            font-family: 'Georgia', serif;
            font-style: italic;
            margin: 0 0.5rem;
        }

        .hero .date {
            font-size: 1.5rem;
            letter-spacing: 0.2rem;
            font-weight: 300;
            margin-top: 1rem;
            animation: fadeInUp 1s ease 0.3s both;
        }

        .hero .location {
            font-size: 1.2rem;
            letter-spacing: 0.15rem;
            margin-top: 0.5rem;
            opacity: 0.9;
            animation: fadeInUp 1s ease 0.5s both;
        }

        .hero .pin {
            line-height: 1;
            margin-top: 0.5rem;
            opacity: 1;
            animation: fadeInUp 1s ease 0.7s both;
            display: inline-block;
        }

        .hero .pin a {
            color: white;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            transition: opacity 0.3s;
        }

        .hero .pin a:hover {
            opacity: 0.8;
        }

        .hero .pin .material-symbols-outlined {
            font-size: 4rem;
            font-variation-settings:
            'FILL' 0,
            'wght' 400,
            'GRAD' 0,
            'opsz' 24;
        }

        .scroll-indicator {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            animation: bounce 2s infinite;
        }

        .scroll-indicator::after {
            content: '‚Üì';
            font-size: 2rem;
            color: white;
            opacity: 0.7;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            padding: 1rem 0;
            opacity: 0;
            animation: slideDown 0.5s ease 1s forwards;
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            gap: 3rem;
        }

        nav a {
            text-decoration: none;
            color: #2c7873;
            font-weight: 500;
            letter-spacing: 0.1rem;
            transition: color 0.3s;
        }

        nav a:hover {
            color: #40b5ad;
        }

        /* Sections */
        section {
            padding: 5rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        h2 {
            font-size: 3rem;
            font-weight: 300;
            text-align: center;
            color: #2c7873;
            margin-bottom: 3rem;
            letter-spacing: 0.2rem;
        }

        .divider {
            width: 80px;
            height: 2px;
            background: #40b5ad;
            margin: 1rem auto 3rem;
        }

        /* Our Story */
        .story-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
            font-size: 1.1rem;
            line-height: 1.8;
            color: #555;
        }

        .story-content p {
            margin-bottom: 1.5rem;
        }

        /* Details Grid */
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 3rem;
            margin-top: 3rem;
        }

        .detail-card {
            background: white;
            padding: 2.5rem;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .detail-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }

        .detail-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .detail-card h3 {
            color: #2c7873;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .detail-card p {
            color: #666;
            line-height: 1.6;
        }

        /* Schedule Timeline */
        .timeline {
            max-width: 600px;
            margin: 3rem auto;
            position: relative;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 100%;
            background: #ddd;
        }

        .timeline-item {
            margin-bottom: 3rem;
            position: relative;
            padding: 0 2rem;
        }

        .timeline-item:nth-child(odd) {
            text-align: right;
            padding-right: calc(50% + 3rem);
        }

        .timeline-item:nth-child(even) {
            text-align: left;
            padding-left: calc(50% + 3rem);
        }

        .timeline-dot {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 16px;
            height: 16px;
            background: #40b5ad;
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 0 0 4px #f0f8f8;
        }

        .timeline-time {
            font-weight: 600;
            color: #40b5ad;
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .timeline-event {
            color: #555;
            font-size: 1rem;
        }

        /* RSVP Section */
        #rsvp {
            background: linear-gradient(135deg, #40b5ad, #9ccfd8);
            color: white;
            padding: 5rem 2rem;
        }

        #rsvp h2 {
            color: white;
        }

        .rsvp-form {
            max-width: 500px;
            margin: 2rem auto;
            background: white;
            padding: 2.5rem;
            border-radius: 10px;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            color: #2c7873;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            font-family: inherit;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            background: #40b5ad;
            color: white;
            padding: 1rem 3rem;
            border: none;
            border-radius: 30px;
            font-size: 1rem;
            cursor: pointer;
            letter-spacing: 0.1rem;
            transition: background 0.3s, transform 0.2s;
            display: block;
            margin: 2rem auto 0;
        }

        .btn:hover {
            background: #2c7873;
            transform: translateY(-2px);
        }

        /* Photo Upload Section */
        #photos {
            background: #fff;
        }

        .photo-upload-container {
            max-width: 600px;
            margin: 2rem auto;
            text-align: center;
        }

        #uploadSection {
            background: white;
            padding: 3rem;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        #uploadSection.hidden {
            display: none;
        }

        .coming-soon {
            padding: 3rem;
            background: #f0f8f8;
            border-radius: 10px;
            color: #666;
            font-size: 1.1rem;
        }

        .upload-area {
            border: 2px dashed #40b5ad;
            border-radius: 10px;
            padding: 3rem;
            margin: 2rem 0;
            background: #f7fcfc;
            cursor: pointer;
            transition: background 0.3s;
        }

        .upload-area:hover {
            background: #edf7f7;
        }

        .upload-icon {
            font-size: 4rem;
            color: #40b5ad;
            margin-bottom: 1rem;
        }

        /* Footer */
        footer {
            background: #2c7873;
            color: white;
            text-align: center;
            padding: 2rem;
        }

        footer p {
            opacity: 0.8;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-100%);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateX(-50%) translateY(0);
            }
            40% {
                transform: translateX(-50%) translateY(-10px);
            }
            60% {
                transform: translateX(-50%) translateY(-5px);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }

            .hero .ampersand {
                font-size: 3rem;
            }

            .hero .date {
                font-size: 1.2rem;
            }

            nav ul {
                flex-wrap: wrap;
                gap: 1rem;
                padding: 0 1rem;
            }

            h2 {
                font-size: 2rem;
            }

            .details-grid {
                grid-template-columns: 1fr;
            }

            .timeline-item:nth-child(odd),
            .timeline-item:nth-child(even) {
                text-align: left;
                padding-left: 3rem;
                padding-right: 1rem;
            }

            .timeline::before {
                left: 0;
            }

            .timeline-dot {
                left: 0;
                transform: translateX(-50%);
            }
        }

        /* Meal Selection Grid */
        .meal-grid {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        .meal-grid th,
        .meal-grid td {
            padding: 0.8rem;
            text-align: center;
            border: 1px solid #ddd;
        }

        .meal-grid th {
            background-color: #f0f8f8;
            color: #2c7873;
            font-weight: 500;
        }

        .meal-grid td:first-child {
            text-align: left;
            font-weight: 500;
            background-color: #f9f9f9;
            color: #2c7873;
        }

        .meal-grid input[type="radio"],
        .meal-grid input[type="checkbox"] {
            width: auto;
            cursor: pointer;
        }

        .meal-grid input[type="text"] {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 0.9rem;
        }

        .guest-name-cell {
            min-width: 150px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <ul>
            <li><a href="#home">Home</a></li>
            <li id="navPhotos" class="hidden"><a href="#photos">Photos</a></li>
            <li><a href="#story">Our Story</a></li>
            <li><a href="#details">Details</a></li>
            <li id="navRSVP"><a href="#rsvp">RSVP</a></li>
        </ul>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1>
                Marilyn <span class="ampersand">&</span> Ian
            </h1>
            <p class="date">JUNE 19, 2027</p>
            <p class="location">Larmer Tree Gardens | Tollard Royal, England, SP5 5PY</p>
            <p class="pin"><a href="https://maps.app.goo.gl/KDg1wauDmnFXBdUB7"><span class="material-symbols-outlined">map_pin_heart</span></a> <a id="wedding-link"><span class="material-symbols-outlined">calendar_add_on</span></a></p>
        </div>
        <div class="scroll-indicator"></div>
    </section>

    <!-- Photos Section - This section will be hidden until the wedding day -->
    <section id="photos" class="hidden">
        <h2>Share Your Photos</h2>
        <div class="divider"></div>
        <div class="photo-upload-container">
            <div id="uploadSection">
                <p style="color: #666; margin-bottom: 2rem; font-size: 1.1rem;">
                    Help us capture every magical moment! Upload your photos from our special day.
                </p>
                <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">üì∏</div>
                    <h3 style="color: #40b5ad; margin-bottom: 0.5rem;">Click to Upload Photos</h3>
                    <p style="color: #666;">or drag and drop your images here</p>
                    <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
                </div>
                <button class="btn" onclick="uploadPhotos()">Upload Photos</button>
            </div>
        </div>
    </section>

    <!-- Our Story -->
    <section id="story">
        <h2>Our Story</h2>
        <div class="divider"></div>
        <div class="story-content">
            <p>
                Our story almost didn't happen. In 2019, Marilyn was arranging a casual meet-up between her best friend and
                a friend she had met through an exercise class, Ian's mate. A "pre-date" to see if they'd get along.  
                Ian's friend asked him to come along for moral support. Ian was exhausted that day 
                and nearly didn't go, but something told him to make the effort. Best decision ever.
            </p>
            <p>
                The moment we met, we clicked. We realised we recognised each other from work and we'd even 
                walked past each other countless times but had never actually spoken. After that evening, 
                we connected on Facebook and started chatting about going to a pub quiz together. The meetings kept coming and 
                we thrived through Covid lockdowns and all the challenges that came with them, growing 
                stronger together through it all. Over six wonderful years later, we now have two 
                amazing sons who fill our lives with joy and chaos in equal measure.
            </p>
            <p>
                Ian proposed during a traditional Christmas visit to the lights at Longleat. 
                Surrounded by the magic and the memories, he asked the most important question of his life.
                Well, at least thats how he imagined it... It was raining, cold, and the kids werent happy
                but months of planning came down to this! 
                In front of the steps of Longleat House Marilyn said yes (obviously), and he whisked her off her feet back to the car (with the kids) to get warm and dry. Who said romance was dead?</p>

            <p>We hope our big day has better weather but regardless of what happens we are excited to say "I do" and celebrate the beginning of this next chapter in beautiful surroundings with all of you beautiful people.
            </p> 
        </div>
    </section>

    <!-- Wedding Details -->
    <section id="details">
        <h2>Wedding Details</h2>
        <div class="divider"></div>
        <div class="details-grid">
            <div class="detail-card">
                <div class="detail-icon">üóìÔ∏è</div>
                <h3>When</h3>
                <p>Saturday, June 19, 2027</p>
                <p>Guests arrive from 1:00 PM</p>
                <p>Ceremony begins at 2:00 PM</p>
            </div>
            <div class="detail-card">
                <div class="detail-icon">üìç</div>
                <h3>Where</h3>
                <p>Larmer Tree Gardens</p>
                <p>Tollard Royal</p>
                <p>Salisbury, England, SP5 5PY</p>
            </div>
            <div class="detail-card">
                <div class="detail-icon">üëî</div>
                <h3>Dress Code</h3>
                <p>Formal Attire</p>
                <p>Suits and cocktail dresses</p>
                <p>Garden party chic</p>
            </div>
        </div>
    </section>

    <!-- RSVP -->
    <section id="rsvp">
        <h2>RSVP</h2>
        <div class="divider"></div>
        <div class="rsvp-form">
            <form id="rsvpForm">
                <div class="form-group">
                    <label for="name">Full Name</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="attendance">Will you be attending?</label>
                    <select id="attendance" name="attendance" required>
                        <option value="">Select...</option>
                        <option value="yes">Joyfully Accept</option>
                        <option value="no">Regretfully Decline</option>
                    </select>
                </div>
                <div class="form-group" id="guestsGroup" style="display: none;">
                    <label for="guests">Number of Attendees (including you)</label>
                    <select id="guests" name="guests">
                        <option value="">Select...</option>
                        <option value="1">1 (just you)</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                    </select>
                </div>
                <div class="form-group" id="guestNamesGroup" style="display: none;">
                    <label>Names of additional guests in your party (please include surname):</label>
                    <div id="guestNamesContainer" style="margin-top: 0.5rem;">
                        <!-- Text boxes will be dynamically generated here -->
                    </div>
                </div>
                <div class="form-group" id="dietaryRestrictionsGroup" style="display: none;">
                    <label style="margin-bottom: 1rem; display: block;">
                        Do you have any dietary choices/restrictions or allergies in your party we should be aware of?
                    </label>
                    <div style="overflow-x: auto;">
                        <table class="meal-grid" id="dietaryRestrictionsTable">
                            <!-- Table will be dynamically generated -->
                        </table>
                    </div>
                </div>
                <div class="form-group" id="dietaryDetailsGroup" style="display: none;">
                    <label for="dietaryDetails">Please specify the 'Other' dietary restrictions/allergies:</label>
                    <textarea id="dietaryDetails" name="dietaryDetails" placeholder="e.g., John Smith - egg allergy, Jane Smith - lactose intolerant"></textarea>
                </div>
                <div class="form-group" id="mealSelectionGroup" style="display: none;">
                    <label style="margin-bottom: 1rem; display: block;">
                        <span style="color: #d9534f; font-weight: bold;">TBC:</span> Please select your main course preference:
                    </label>
                    <div style="overflow-x: auto;">
                        <table class="meal-grid" id="mealSelectionTable">
                            <!-- Table will be dynamically generated -->
                        </table>
                    </div>
                </div>
                <div class="form-group" id="stayingOvernightGroup" style="display: none;">
                    <label for="stayingOvernight">Are you thinking of staying overnight at Larmer Tree?</label>
                    <select id="stayingOvernight" name="stayingOvernight">
                        <option value="">Select...</option>
                        <option value="yes">Yes</option>
                        <option value="no">No</option>
                    </select>
                </div>
                <div class="form-group" id="accommodationGroup" style="display: none;">
                    <label for="accommodation">Where are you planning to sleep?</label>
                    <select id="accommodation" name="accommodation">
                        <option value="">Select...</option>
                        <option value="yurt">I would like information about hiring a glamping yurt</option>
                        <option value="tent">My own tent/caravan/campervan</option>
                    </select>
                </div>
                <div class="form-group" id="songRequestGroup" style="display: none;">
                    <label for="songRequest">Finally: What song is likely to get you on the dancefloor?</label>
                    <input type="text" id="songRequest" name="songRequest" placeholder="song name by artist">
                </div>
                <button type="submit" class="btn">Submit RSVP</button>
                <!-- investigate submitting to an online spreadsheet-->
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <p>We can't wait to celebrate with you!</p>
        <p style="margin-top: 0.5rem;">&hearts; Marilyn & Ian &hearts;</p>
    </footer>

    <script>
        // Save the date handler
        function generateWeddingICS() {
            const wedding = {
                title: "Wedding of Marilyn and Ian",
                description: "We are so excited to celebrate our wedding day with you at the Larmer Tree Gardens. See you there!",
                location: "Larmer Tree Gardens, Salisbury SP5 5PY, UK",
                startDate: "20270619", // date in ISO format YYYYMMDD because coding is for weirdos
                endDate: "20270620",   // end the day after to make it all day
                alarmTrigger: "-P7D"   // remind 7 days before
            };

            const icsContent = [
                "BEGIN:VCALENDAR",
                "VERSION:2.0",
                "PRODID:-//Wedding Planner//EN",
                "BEGIN:VEVENT",
                `DTSTART;VALUE=DATE:${wedding.startDate}`,
                `DTEND;VALUE=DATE:${wedding.endDate}`,
                `SUMMARY:${wedding.title}`,
                `DESCRIPTION:${wedding.description}`,
                `LOCATION:${wedding.location}`,
                "BEGIN:VALARM",
                "TRIGGER:-P7D",
                "ACTION:DISPLAY",
                `DESCRIPTION:Reminder: Marilyn and Ian's wedding is in one week!`,
                "END:VALARM",
                "END:VEVENT",
                "END:VCALENDAR"
            ].join("\n");

            const blob = new Blob([icsContent], { type: "text/calendar;charset=utf-8" });
            const url = URL.createObjectURL(blob);

            const link = document.getElementById("wedding-link");
            link.href = url;
            link.download = "Wedding-Marilyn-and-Ian.ics";
        }

        window.onload = generateWeddingICS; // create the ICS on page load even if its not used

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Show/hide guests field based on attendance
        function toggleGuestsField() {
            const attendanceSelect = document.getElementById('attendance');
            const guestsGroup = document.getElementById('guestsGroup');
            const guestsSelect = document.getElementById('guests');
            const stayingOvernightGroup = document.getElementById('stayingOvernightGroup');
            const stayingOvernightSelect = document.getElementById('stayingOvernight');
            const accommodationGroup = document.getElementById('accommodationGroup');
            const accommodationSelect = document.getElementById('accommodation');
            const songRequestGroup = document.getElementById('songRequestGroup');
            const songRequestInput = document.getElementById('songRequest');
            
            if (attendanceSelect.value === 'yes') {
                guestsGroup.style.display = 'block';
                guestsSelect.required = true;
                stayingOvernightGroup.style.display = 'block';
                stayingOvernightSelect.required = true;
                songRequestGroup.style.display = 'block';
            } else {
                guestsGroup.style.display = 'none';
                guestsSelect.value = ''; // Reset guests selection
                guestsSelect.required = false;
                generateGuestNameFields(); // Update guest name fields
                generateMealSelectionGrid(); // Update meal grid
                
                // Hide and reset staying overnight and accommodation
                stayingOvernightGroup.style.display = 'none';
                stayingOvernightSelect.value = '';
                stayingOvernightSelect.required = false;
                accommodationGroup.style.display = 'none';
                accommodationSelect.value = '';
                accommodationSelect.required = false;
                
                // Hide and reset song request
                songRequestGroup.style.display = 'none';
                songRequestInput.value = '';
                songRequestInput.required = false;
            }
        }

        // Generate guest name text boxes
        function generateGuestNameFields() {
            const guestsSelect = document.getElementById('guests');
            const guestNamesGroup = document.getElementById('guestNamesGroup');
            const guestNamesContainer = document.getElementById('guestNamesContainer');
            const numGuests = parseInt(guestsSelect.value);

            // Show guest name fields only if more than 1 attendee
            if (numGuests > 1) {
                guestNamesGroup.style.display = 'block';
                
                let fieldsHTML = '';
                // Generate text boxes for additional guests (excluding the main person)
                for (let i = 1; i < numGuests; i++) {
                    fieldsHTML += `
                        <div style="margin-bottom: 0.8rem;">
                            <input type="text"
                                   id="guestName_${i}"
                                   name="guestName_${i}"
                                   placeholder="Guest ${i} full name"
                                   style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem;"
                                   required>
                        </div>
                    `;
                }
                guestNamesContainer.innerHTML = fieldsHTML;
            } else {
                guestNamesGroup.style.display = 'none';
                guestNamesContainer.innerHTML = '';
            }
        }

        // Dynamic Meal Selection Grid
        function generateMealSelectionGrid() {
            const nameInput = document.getElementById('name');
            const guestsSelect = document.getElementById('guests');
            const attendanceSelect = document.getElementById('attendance');
            const mealSelectionGroup = document.getElementById('mealSelectionGroup');
            const mealSelectionTable = document.getElementById('mealSelectionTable');

            const name = nameInput.value.trim();
            const numGuests = parseInt(guestsSelect.value);
            const attendance = attendanceSelect.value;

            // Only show meal selection if attending and guests selected
            if (attendance === 'yes' && numGuests > 0 && name) {
                mealSelectionGroup.style.display = 'block';

                // Generate table
                let tableHTML = `
                    <thead>
                        <tr>
                            <th></th>
                            <th>Chicken (Poultry)</th>
                            <th>Beef (Red Meat)</th>
                            <th>Fish (Seafood)</th>
                            <th>Vegetarian</th>
                            <th>Vegan</th>
                        </tr>
                    </thead>
                    <tbody>
                `;

                // First row - use the name from the name field
                tableHTML += `
                    <tr>
                        <td class="guest-name-cell">${name}</td>
                        <td><input type="radio" name="meal_0" value="chicken" required></td>
                        <td><input type="radio" name="meal_0" value="beef" required></td>
                        <td><input type="radio" name="meal_0" value="fish" required></td>
                        <td><input type="radio" name="meal_0" value="vegetarian" required></td>
                        <td><input type="radio" name="meal_0" value="vegan" required></td>
                    </tr>
                `;

                // Additional rows for guests - use names from guest name inputs
                for (let i = 1; i < numGuests; i++) {
                    const guestNameInput = document.getElementById(`guestName_${i}`);
                    const guestName = guestNameInput ? guestNameInput.value.trim() : '';
                    const displayName = guestName || `Guest ${i}`;
                    
                    tableHTML += `
                        <tr>
                            <td class="guest-name-cell">${displayName}</td>
                            <td><input type="radio" name="meal_${i}" value="chicken" required></td>
                            <td><input type="radio" name="meal_${i}" value="beef" required></td>
                            <td><input type="radio" name="meal_${i}" value="fish" required></td>
                            <td><input type="radio" name="meal_${i}" value="vegetarian" required></td>
                            <td><input type="radio" name="meal_${i}" value="vegan" required></td>
                        </tr>
                    `;
                }

                tableHTML += `
                    </tbody>
                `;

                mealSelectionTable.innerHTML = tableHTML;
            } else {
                mealSelectionGroup.style.display = 'none';
            }
        }

        // Dynamic Dietary Restrictions Grid
        function generateDietaryRestrictionsGrid() {
            const nameInput = document.getElementById('name');
            const guestsSelect = document.getElementById('guests');
            const attendanceSelect = document.getElementById('attendance');
            const dietaryRestrictionsGroup = document.getElementById('dietaryRestrictionsGroup');
            const dietaryRestrictionsTable = document.getElementById('dietaryRestrictionsTable');

            const name = nameInput.value.trim();
            const numGuests = parseInt(guestsSelect.value);
            const attendance = attendanceSelect.value;

            // Only show dietary restrictions if attending and guests selected
            if (attendance === 'yes' && numGuests > 0 && name) {
                dietaryRestrictionsGroup.style.display = 'block';

                // Generate table
                let tableHTML = `
                    <thead>
                        <tr>
                            <th></th>
                            <th>None</th>
                            <th>Gluten-Free</th>
                            <th>Dairy-Free</th>
                            <th>Nut Allergy</th>
                            <th>Shellfish Allergy</th>
                            <th>Vegan</th>
                            <th>Vegetarian</th>
                            <th>Other</th>
                        </tr>
                    </thead>
                    <tbody>
                `;

                // First row - use the name from the name field
                tableHTML += `
                    <tr>
                        <td class="guest-name-cell">${name}</td>
                        <td><input type="checkbox" name="dietary_0_none" value="none"></td>
                        <td><input type="checkbox" name="dietary_0_gluten" value="gluten-free"></td>
                        <td><input type="checkbox" name="dietary_0_dairy" value="dairy-free"></td>
                        <td><input type="checkbox" name="dietary_0_nut" value="nut-allergy"></td>
                        <td><input type="checkbox" name="dietary_0_shellfish" value="shellfish-allergy"></td>
                        <td><input type="checkbox" name="dietary_0_vegan" value="vegan"></td>
                        <td><input type="checkbox" name="dietary_0_vegetarian" value="vegetarian"></td>
                        <td><input type="checkbox" name="dietary_0_other" value="other"></td>
                    </tr>
                `;

                // Additional rows for guests
                for (let i = 1; i < numGuests; i++) {
                    const guestNameInput = document.getElementById(`guestName_${i}`);
                    const guestName = guestNameInput ? guestNameInput.value.trim() : '';
                    const displayName = guestName || `Guest ${i}`;
                    
                    tableHTML += `
                        <tr>
                            <td class="guest-name-cell">${displayName}</td>
                            <td><input type="checkbox" name="dietary_${i}_none" value="none"></td>
                            <td><input type="checkbox" name="dietary_${i}_gluten" value="gluten-free"></td>
                            <td><input type="checkbox" name="dietary_${i}_dairy" value="dairy-free"></td>
                            <td><input type="checkbox" name="dietary_${i}_nut" value="nut-allergy"></td>
                            <td><input type="checkbox" name="dietary_${i}_shellfish" value="shellfish-allergy"></td>
                            <td><input type="checkbox" name="dietary_${i}_vegan" value="vegan"></td>
                            <td><input type="checkbox" name="dietary_${i}_vegetarian" value="vegetarian"></td>
                            <td><input type="checkbox" name="dietary_${i}_other" value="other"></td>
                        </tr>
                    `;
                }

                tableHTML += `
                    </tbody>
                `;

                dietaryRestrictionsTable.innerHTML = tableHTML;
            } else {
                dietaryRestrictionsGroup.style.display = 'none';
            }
        }

        // Listen for changes to trigger meal selection grid generation
        document.getElementById('name').addEventListener('input', function() {
            generateMealSelectionGrid();
            generateDietaryRestrictionsGrid();
        });
        document.getElementById('guests').addEventListener('change', function() {
            generateGuestNameFields();
            generateMealSelectionGrid();
            generateDietaryRestrictionsGrid();
        });
        document.getElementById('attendance').addEventListener('change', function() {
            toggleGuestsField();
            generateMealSelectionGrid();
            generateDietaryRestrictionsGrid();
        });

        // Listen for guest name changes to update both meal selection and dietary restrictions grids
        document.getElementById('guestNamesContainer').addEventListener('input', function(e) {
            if (e.target.id && e.target.id.startsWith('guestName_')) {
                generateMealSelectionGrid();
                generateDietaryRestrictionsGrid();
            }
        });

        // Show/hide dietary details textarea based on "Other" checkbox selection
        function toggleDietaryDetails() {
            const dietaryDetailsGroup = document.getElementById('dietaryDetailsGroup');
            const dietaryDetailsTextarea = document.getElementById('dietaryDetails');
            const dietaryTable = document.getElementById('dietaryRestrictionsTable');
            
            // Check if any "Other" checkbox is checked
            const otherCheckboxes = dietaryTable.querySelectorAll('input[name*="_other"]');
            const anyOtherChecked = Array.from(otherCheckboxes).some(checkbox => checkbox.checked);
            
            if (anyOtherChecked) {
                dietaryDetailsGroup.style.display = 'block';
                dietaryDetailsTextarea.required = true;
            } else {
                dietaryDetailsGroup.style.display = 'none';
                dietaryDetailsTextarea.required = false;
            }
        }

        // Listen for changes to dietary restriction checkboxes
        document.getElementById('dietaryRestrictionsTable').addEventListener('change', function(e) {
            if (e.target.type === 'checkbox') {
                toggleDietaryDetails();
            }
        });

        // Show/hide accommodation question based on staying overnight selection
        function toggleAccommodationQuestion() {
            const stayingOvernightSelect = document.getElementById('stayingOvernight');
            const accommodationGroup = document.getElementById('accommodationGroup');
            const accommodationSelect = document.getElementById('accommodation');
            
            if (stayingOvernightSelect.value === 'yes') {
                accommodationGroup.style.display = 'block';
                accommodationSelect.required = true;
            } else {
                accommodationGroup.style.display = 'none';
                accommodationSelect.value = ''; // Reset accommodation selection
                accommodationSelect.required = false;
            }
        }

        // Listen for changes to staying overnight selection
        document.getElementById('stayingOvernight').addEventListener('change', toggleAccommodationQuestion);

        // RSVP Form submission
        document.getElementById('rsvpForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate dietary restrictions - at least one checkbox per person
            const attendanceSelect = document.getElementById('attendance');
            const guestsSelect = document.getElementById('guests');
            const numGuests = parseInt(guestsSelect.value);
            
            if (attendanceSelect.value === 'yes' && numGuests > 0) {
                let allValid = true;
                let invalidGuests = [];
                
                for (let i = 0; i < numGuests; i++) {
                    const checkboxes = document.querySelectorAll(`input[name^="dietary_${i}_"]`);
                    const anyChecked = Array.from(checkboxes).some(cb => cb.checked);
                    
                    if (!anyChecked) {
                        allValid = false;
                        if (i === 0) {
                            invalidGuests.push(document.getElementById('name').value);
                        } else {
                            const guestNameInput = document.getElementById(`guestName_${i}`);
                            const guestName = guestNameInput ? guestNameInput.value.trim() : '';
                            invalidGuests.push(guestName || `Guest ${i}`);
                        }
                    }
                }
                
                if (!allValid) {
                    alert(`Please select at least one dietary option for: ${invalidGuests.join(', ')}`);
                    return;
                }
            }
            
            // Get form data
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                guests: document.getElementById('guests').value,
                attendance: document.getElementById('attendance').value,
                dietary: document.getElementById('dietary').value
            };

            // Here you would typically send this data to a backend service
            // For now, we'll just show a confirmation
            if (formData.attendance === 'yes') {
                alert(`Thanks for your RSVP, ${formData.name}! We are thrilled that you will be joining us with ${formData.guests} guest(s).`);
            } else {
                alert(`Thanks for your RSVP, ${formData.name}. We're sorry you can't make it.`);
            }
            this.reset();
            
            // In production, you might use something like:
            // fetch('/api/rsvp', {
            //     method: 'POST',
            //     headers: { 'Content-Type': 'application/json' },
            //     body: JSON.stringify(formData)
            // });
        });

        // Photo Upload Date Control
        function checkPhotoUploadAvailability() {
            const weddingDate = new Date('2027-06-19');
            const currentDate = new Date();
            
            // Show upload section if current date is on or after wedding date
            if (currentDate >= weddingDate) {
                // After wedding - show everything
                document.getElementById('photos').classList.remove('hidden');
                document.getElementById('navPhotos').classList.remove('hidden');
                // Hide RSVP - only weirdos would use this after the wedding 
                document.getElementById('navRSVP').classList.add('hidden');
                document.getElementById('rsvp').classList.add('hidden');
            } else {
                // Hide RSVP section either if its not needed yet or automatically 6 weeks before wedding - people will probably tell us without the site around then anyway
                const sixWeeksBeforeWedding = new Date(weddingDate);
                sixWeeksBeforeWedding.setDate(weddingDate.getDate() - 42);
                if (currentDate >= sixWeeksBeforeWedding || rsvpOpen === false) {
                    document.getElementById('navRSVP').classList.add('hidden');
                    document.getElementById('rsvp').classList.add('hidden');
                }
                // Before wedding - hide photos section
                document.getElementById('photos').classList.add('hidden');
                document.getElementById('navPhotos').classList.add('hidden'); 
            }
        }

        // Photo Upload Function
        function uploadPhotos() {
            const fileInput = document.getElementById('fileInput');
            const files = fileInput.files;
            
            if (files.length === 0) {
                alert('Please select photos to upload.');
                return;
            }

            // Here you would implement actual file upload to your backend
            // This is a placeholder that shows what the user selected
            alert(`Ready to upload ${files.length} photo(s). 

In production, you would integrate this with:
- Google Photos API
- Cloudinary
- AWS S3
- Or your preferred cloud storage solution`);

            // Reset file input
            fileInput.value = '';
            
            // In production, you might use something like:
            // const formData = new FormData();
            // for (let file of files) {
            //     formData.append('photos', file);
            // }
            // fetch('/api/upload-photos', {
            //     method: 'POST',
            //     body: formData
            // });
        }

        // Drag and drop functionality
        const uploadArea = document.querySelector('.upload-area');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadArea?.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            uploadArea?.addEventListener(eventName, () => {
                uploadArea.style.background = '#dff2f1';
            }, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadArea?.addEventListener(eventName, () => {
                uploadArea.style.background = '#f7fcfc';
            }, false);
        });

        uploadArea?.addEventListener('drop', (e) => {
            const dt = e.dataTransfer;
            const files = dt.files;
            document.getElementById('fileInput').files = files;
        }, false);

        // Check photo upload availability on page load
        checkPhotoUploadAvailability();
        
        // Optional: Check every hour if someone leaves the page open
        setInterval(checkPhotoUploadAvailability, 3600000);
    </script>
</body>
</html>
